/*
 * Ext JS Library 1.0 Beta 2
 * Copyright(c) 2006-2007, Ext JS, LLC.
 * licensing@extjs.com
 * 
 * http://www.extjs.com/license
 */

Ext.form.Action=function(_1,_2){this.form=_1;this.options=_2||{};};Ext.form.Action.CLIENT_INVALID="client";Ext.form.Action.SERVER_INVALID="server";Ext.form.Action.CONNECT_FAILURE="connect";Ext.form.Action.LOAD_FAILURE="load";Ext.form.Action.prototype={type:"default",failureType:undefined,response:undefined,result:undefined,run:function(_3){},success:function(_4){},failure:function(_5){this.failureType=Ext.form.Action.CONNECT_FAILURE;this.form.afterAction(this,false);},processResponse:function(_6){this.response=_6;if(!_6.responseText){this.result=true;}else{this.result=Ext.decode(_6.responseText);}return this.result;},getUrl:function(_7){var _8=this.options.url||this.form.url||this.form.el.dom.action;if(_7){var p=this.getParams();if(p){_8+=(_8.indexOf("?")!=-1?"&":"?")+p;}}return _8;},getMethod:function(){return (this.options.method||this.form.method||this.form.el.dom.method||"POST").toUpperCase();},getParams:function(){var bp=this.form.baseParams;var p=this.options.params;if(p){if(typeof p=="object"){p=Ext.urlEncode(Ext.applyIf(p,bp));}else{if(typeof p=="string"&&bp){p+="&"+Ext.urlEncode(bp);}}}else{if(bp){p=Ext.urlEncode(bp);}}return p;},createCallback:function(){return {success:this.success,failure:this.failure,scope:this,timeout:(this.form.timeout*1000),upload:this.form.fileUpload?this.success:undefined};}};Ext.form.Action.Submit=function(_c,_d){Ext.form.Action.Submit.superclass.constructor.call(this,_c,_d);};Ext.extend(Ext.form.Action.Submit,Ext.form.Action,{type:"submit",run:function(){var o=this.options;var _f=this.getMethod()=="POST";if(o.clientValidation===false||this.form.isValid()){Ext.lib.Ajax.formRequest(this.form.el.dom,this.getUrl(!_f),this.createCallback(),_f?this.getParams():null,this.form.fileUpload,Ext.SSL_SECURE_URL);}else{if(o.clientValidation!==false){this.failureType=Ext.form.Action.CLIENT_INVALID;this.form.afterAction(this,false);}}},success:function(_10){var _11=this.processResponse(_10);if(_11===true||_11.success){this.form.afterAction(this,true);return;}if(_11.errors){this.form.markInvalid(_11.errors);this.failureType=Ext.form.Action.SERVER_INVALID;this.form.afterAction(this,false);}}});Ext.form.Action.Load=function(_12,_13){Ext.form.Action.Load.superclass.constructor.call(this,_12,_13);};Ext.extend(Ext.form.Action.Load,Ext.form.Action,{type:"load",run:function(){Ext.lib.Ajax.request(this.getMethod(),this.getUrl(false),this.createCallback(),this.getParams());},success:function(_14){var _15=this.processResponse(_14);if(_15===true||!_15.success||!_15.data){this.failureType=Ext.form.Action.LOAD_FAILURE;this.form.afterAction(this,false);return;}this.form.clearInvalid();this.form.setValues(_15.data);this.form.afterAction(this,true);}});Ext.form.Action.ACTION_TYPES={"load":Ext.form.Action.Load,"submit":Ext.form.Action.Submit};
